<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Lab Test Report</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: "Arial", sans-serif;
			line-height: 1.6;
			color: #333;
			background-color: #fff;
		}

		.header {
			background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
			color: white;
			padding: 20px;
			text-align: center;
			position: relative;
		}

		.header img {
			position: absolute;
			left: 20px;
			top: 50%;
			transform: translateY(-50%);
			height: 60px;
			width: auto;
		}

		.header h1 {
			font-size: 24px;
			margin-bottom: 5px;
		}

		.header p {
			font-size: 14px;
			opacity: 0.9;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
			padding: 20px;
		}

		.patient-info {
			background: #f8f9fa;
			border: 1px solid #e9ecef;
			border-radius: 8px;
			padding: 20px;
			margin-bottom: 20px;
		}

		.patient-info h2 {
			color: #1e40af;
			margin-bottom: 15px;
			font-size: 18px;
		}

		.info-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 15px;
		}

		.info-item {
			display: flex;
			justify-content: space-between;
			padding: 8px 0;
			border-bottom: 1px solid #e9ecef;
		}

		.info-item:last-child {
			border-bottom: none;
		}

		.info-label {
			font-weight: 600;
			color: #495057;
		}

		.info-value {
			color: #212529;
		}

		.test-info {
			background: #fff;
			border: 1px solid #e9ecef;
			border-radius: 8px;
			padding: 20px;
			margin-bottom: 20px;
		}

		.test-info h2 {
			color: #1e40af;
			margin-bottom: 15px;
			font-size: 18px;
		}

		.results-table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 15px;
			background: white;
			border-radius: 8px;
			overflow: hidden;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.results-table th {
			background: #1e40af;
			color: white;
			padding: 12px;
			text-align: left;
			font-weight: 600;
		}

		.results-table td {
			padding: 12px;
			border-bottom: 1px solid #e9ecef;
		}

		.results-table tr:nth-child(even) {
			background: #f8f9fa;
		}

		.results-table tr:last-child td {
			border-bottom: none;
		}

		.status-normal {
			color: #28a745;
			font-weight: 600;
		}

		.status-high {
			color: #dc3545;
			font-weight: 600;
		}

		.status-low {
			color: #ffc107;
			font-weight: 600;
		}

		.footer {
			margin-top: 30px;
			padding: 20px;
			background: #f8f9fa;
			border-radius: 8px;
			text-align: center;
		}

		.footer p {
			margin-bottom: 10px;
			color: #6c757d;
		}

		.signature-section {
			margin-top: 30px;
			display: flex;
			justify-content: space-between;
			align-items: flex-end;
		}

		.signature-box {
			text-align: center;
			flex: 1;
			margin: 0 20px;
		}

		.signature-line {
			border-top: 2px solid #333;
			margin-top: 50px;
			padding-top: 10px;
		}

		.report-date {
			text-align: right;
			margin-bottom: 20px;
			color: #6c757d;
			font-size: 14px;
		}

		.no-results {
			text-align: center;
			padding: 40px;
			color: #6c757d;
			font-style: italic;
		}

		@media print {
			.header {
				-webkit-print-color-adjust: exact;
				color-adjust: exact;
			}

			.results-table th {
				-webkit-print-color-adjust: exact;
				color-adjust: exact;
			}
		}
	</style>
</head>

<body>
	<div class="header">
		{{#if logoUrl}}
		<img src="{{logoUrl}}" alt="Hospital Logo" />
		{{/if}}
		<h1>LABORATORY TEST REPORT</h1>
		<p>{{hospital.name}}</p>
	</div>

	<div class="container">
		<div class="report-date">
			<strong>Report Date:</strong> {{formatDateTime currentDate}}
		</div>

		<div class="patient-info">
			<h2>Patient Information</h2>
			<div class="info-grid">
				<div class="info-item">
					<span class="info-label">Patient Name:</span>
					<span class="info-value">{{patient.name}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Patient ID:</span>
					<span class="info-value">{{patient.uhid}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Age:</span>
					<span class="info-value">{{patientAge}} years</span>
				</div>
				<div class="info-item">
					<span class="info-label">Gender:</span>
					<span class="info-value">{{patient.gender}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Blood Group:</span>
					<span class="info-value">{{patient.bloodGroup}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Phone:</span>
					<span class="info-value">{{patient.phone}}</span>
				</div>
			</div>
		</div>

		<div class="test-info">
			<h2>Test Information</h2>
			<div class="info-grid">
				<div class="info-item">
					<span class="info-label">Test Name:</span>
					<span class="info-value">{{labTest.labTest.name}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Test Code:</span>
					<span class="info-value">{{labTest.labTest.code}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Sample Type:</span>
					<span class="info-value">{{labTest.labTest.sampleType}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Test Date:</span>
					<span class="info-value">{{formatDateTime labTest.createdAt}}</span>
				</div>
				<div class="info-item">
					<span class="info-label">Status:</span>
					<span class="info-value">{{labTest.status}}</span>
				</div>
				{{#if labTest.tentativeReportDate}}
				<div class="info-item">
					<span class="info-label">Report Date:</span>
					<span class="info-value">{{formatDateTime labTest.tentativeReportDate}}</span>
				</div>
				{{/if}}
			</div>
		</div>

		{{#if results.length}}
		<div class="test-info">
			<h2>Test Results</h2>
			<table class="results-table">
				<thead>
					<tr>
						<th>Parameter</th>
						<th>Value</th>
						<th>Unit</th>
						<th>Reference Range</th>
						<th>Status</th>
					</tr>
				</thead>
				<tbody>
					{{#each results}}
					<tr>
						<td>{{parameter.name}}</td>
						<td>{{value}}</td>
						<td>
							{{#if
							unitOverride}}{{unitOverride}}{{else}}{{parameter.unit}}{{/if}}
						</td>
						<td>
							{{#if parameter.lowerLimit}}{{parameter.lowerLimit}}{{/if}}
							{{#if parameter.upperLimit}} - {{parameter.upperLimit}}{{/if}}
						</td>
						<td>
							{{#if (eq value parameter.lowerLimit)}}
							<span class="status-normal">Normal</span>
							{{else if (eq value parameter.upperLimit)}}
							<span class="status-normal">Normal</span>
							{{else if (gt value parameter.upperLimit)}}
							<span class="status-high">High</span>
							{{else if (lt value parameter.lowerLimit)}}
							<span class="status-low">Low</span>
							{{else}}
							<span class="status-normal">Normal</span>
							{{/if}}
						</td>
					</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
		{{else}}
		<div class="test-info">
			<h2>Test Results</h2>
			<div class="no-results">
				No test results available yet. Results will be updated once the test
				is completed.
			</div>
		</div>
		{{/if}} {{#if labTest.notes}}
		<div class="test-info">
			<h2>Notes</h2>
			<p>{{labTest.notes}}</p>
		</div>
		{{/if}}

		<div class="signature-section">
			<div class="signature-box">
				<div class="signature-line"></div>
				<p><strong>Lab Technician</strong></p>
			</div>
			<div class="signature-box">
				<div class="signature-line"></div>
				<p><strong>Authorized Signatory</strong></p>
			</div>
		</div>

		<div class="footer">
			<p><strong>{{hospital.name}}</strong></p>
			<p>{{hospital.address}}</p>
			<p>Phone: {{hospital.contactNumber}} | Email: {{hospital.email}}</p>
			<p style="margin-top: 15px; font-size: 12px; color: #6c757d">
				This is a computer-generated report. No physical signature is
				required.
			</p>
		</div>
	</div>
</body>

</html>